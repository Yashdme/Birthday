<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        .handwriting {
            font-family: 'Dancing Script', cursive;
        }

        /* --- Background Animation --- */
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Floating background particles */
        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float-particle linear infinite;
            bottom: -50px;
            pointer-events: none;
        }

        @keyframes float-particle {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.5; }
            100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
        }

        /* --- Gift Box Animations --- */
        @keyframes float-box {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
        }

        .floating-box {
            animation: float-box 3s ease-in-out infinite;
        }

        .shake-hover:hover {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both infinite;
            cursor: pointer;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0) rotate(-1deg); }
            20%, 80% { transform: translate3d(2px, 0, 0) rotate(2deg); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0) rotate(-4deg); }
            40%, 60% { transform: translate3d(4px, 0, 0) rotate(4deg); }
        }

        .explode-box {
            animation: explode 0.6s forwards ease-in;
        }

        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.8; }
            100% { transform: scale(5); opacity: 0; display: none; }
        }

        /* --- Card Entrance Animations --- */
        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.5) translateY(50px); }
            60% { opacity: 1; transform: scale(1.05) translateY(-10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .card-pop-in {
            display: block !important;
            animation: popIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        /* Staggered Text Reveal */
        .stagger-reveal {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease-out;
        }
        
        .stagger-reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Music Button Animation */
        .music-btn-anim {
            animation: pulse-ring 2s infinite;
        }

        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(236, 72, 153, 0); }
            100% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0); }
        }

        /* Balloon Animations */
        .balloon {
            position: absolute;
            bottom: -100px;
            opacity: 0.9;
            border-radius: 50%;
            animation: riseUp 8s ease-in infinite;
            box-shadow: inset -10px -10px 0 rgba(0,0,0,0.1);
        }
        
        .balloon::before {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            width: 2px;
            height: 40px;
            background: rgba(255,255,255,0.6);
            transform: translateX(-50%);
        }

        @keyframes riseUp {
            0% { bottom: -100px; transform: translateX(0); }
            25% { transform: translateX(20px) rotate(5deg); }
            50% { transform: translateX(-15px) rotate(-5deg); }
            75% { transform: translateX(10px) rotate(2deg); }
            100% { bottom: 120vh; transform: translateX(-10px); }
        }
    </style>
</head>
<body class="h-screen w-screen flex items-center justify-center relative overflow-hidden">

    <!-- Background Particles Container -->
    <div id="particles" class="absolute inset-0 w-full h-full pointer-events-none"></div>

    <!-- Confetti Canvas -->
    <canvas id="confetti-canvas" class="absolute top-0 left-0 w-full h-full pointer-events-none z-50"></canvas>

    <!-- Intro Screen (Gift Box) -->
    <div id="intro-screen" class="z-40 text-center flex flex-col items-center justify-center">
        <div class="text-white mb-8 text-2xl font-semibold tracking-wider uppercase drop-shadow-md">
            A Surprise For You
        </div>
        
        <div id="gift-box" class="floating-box shake-hover relative group cursor-pointer transition-all duration-300">
            <!-- Gift Box Icon -->
            <div class="relative text-[150px] text-yellow-400 drop-shadow-2xl filter hover:brightness-110">
                <i class="fas fa-gift"></i>
            </div>
            <!-- Pulsing Text -->
            <div class="mt-8 px-8 py-3 bg-white/20 backdrop-blur-md rounded-full text-white font-bold border border-white/40 animate-pulse shadow-lg">
                Click to Open
            </div>
        </div>
    </div>

    <!-- Music Toggle Button (Fixed to top right) -->
    <button id="music-toggle" class="hidden fixed top-5 right-5 z-50 bg-white/20 backdrop-blur-md p-3 rounded-full text-white hover:bg-white/40 transition-all shadow-lg music-btn-anim" onclick="toggleMusic()">
        <i class="fas fa-music"></i>
    </button>

    <!-- Main Birthday Card -->
    <div id="main-card" class="hidden z-40 max-w-md w-full mx-4 transform origin-center">
        <div class="bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl overflow-hidden p-8 text-center relative border-4 border-pink-200/50 max-h-[90vh] overflow-y-auto custom-scrollbar">
            
            <!-- Decorative Badge -->
            <div class="stagger-reveal absolute -top-6 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-pink-500 to-purple-600 text-white px-6 py-2 rounded-full shadow-xl flex items-center gap-2">
                <i class="fas fa-crown text-yellow-300"></i> 
                <span class="font-semibold tracking-wide">Special Day</span>
            </div>

            <!-- Cake Icon -->
            <div class="stagger-reveal mt-6 mb-4 text-7xl text-pink-500 drop-shadow-md">
                <i class="fas fa-birthday-cake"></i>
            </div>

            <!-- Headline -->
            <h1 class="stagger-reveal handwriting text-6xl text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2 drop-shadow-sm pb-2">
                Happy Birthday!
            </h1>

            <!-- Customizable Name -->
            <h2 class="stagger-reveal text-3xl font-bold text-gray-800 mb-6">
                My Dearest Friend
            </h2>

            <!-- Message Body -->
            <p class="stagger-reveal text-gray-600 leading-relaxed mb-8 text-lg">
                Wishing you a day filled with love, laughter, and all your favorite things. 
                May this year bring you endless adventures and happiness. You deserve it all!
            </p>

            <!-- Action Buttons -->
            <div class="stagger-reveal flex flex-col gap-4 justify-center">
                
                <!-- Standard Replay Button -->
                <button onclick="replayCelebration()" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-600 px-8 py-3 rounded-full transition-all transform shadow flex items-center justify-center font-semibold">
                    <i class="fas fa-redo mr-2"></i> Replay Animation
                </button>

                <!-- Special Message Button -->
                <button onclick="toggleMessage()" class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white px-8 py-3 rounded-full transition-all transform hover:scale-105 shadow-lg flex items-center justify-center font-bold border-2 border-indigo-300/30">
                    <i class="fas fa-envelope-open-text mr-2 text-yellow-300"></i> Read Special Message
                </button>
            </div>

            <!-- Special Message Section (Hidden initially) -->
            <div id="message-section" class="hidden mt-6 border-t-2 border-gray-100 pt-6 animate-fade-in">
                <div class="min-h-[80px] bg-indigo-50 rounded-xl p-6 flex flex-col items-center justify-center text-center relative">
                    
                    <div class="text-indigo-900 font-medium text-lg leading-relaxed handwriting">
                        <!-- ⬇️ EDIT YOUR CUSTOM LINES HERE ⬇️ -->
                        "Here's to the moments we've shared,<br>
                        And the memories we've yet to make.<br>
                        May your birthday be filled with joy,<br>
                        And as much cake as you can take!"
                        <!-- ⬆️ EDIT YOUR CUSTOM LINES HERE ⬆️ -->
                    </div>
                    
                    <div class="mt-4 text-indigo-400 text-sm">
                        <i class="fas fa-heart"></i>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Footer -->
    <div class="absolute bottom-5 right-5 z-50 opacity-40 hover:opacity-100 transition-opacity">
        <div class="text-white text-xs text-center">Built with ❤️</div>
    </div>

    <!-- Balloons Container -->
    <div id="balloons-container" class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-10 hidden"></div>

    <script>
        // --- Config & Elements ---
        const giftBox = document.getElementById('gift-box');
        const introScreen = document.getElementById('intro-screen');
        const mainCard = document.getElementById('main-card');
        const balloonsContainer = document.getElementById('balloons-container');
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        const particlesContainer = document.getElementById('particles');
        const musicBtn = document.getElementById('music-toggle');
        const messageSection = document.getElementById('message-section');

        // --- Initialization ---
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        createBackgroundParticles();

        // --- Message Toggle Logic ---
        function toggleMessage() {
            messageSection.classList.toggle('hidden');
            if(!messageSection.classList.contains('hidden')) {
                messageSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // --- Audio Context Setup ---
        let audioCtx;
        let isPlaying = false;
        let oscillatorNodes = [];

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        function playNote(freq, type, duration, startTime) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            
            osc.type = type;
            osc.frequency.value = freq;
            
            // Envelope to make it sound nice (fade in/out)
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.1, startTime + 0.05);
            gain.gain.exponentialRampToValueAtTime(0.001, startTime + duration);

            osc.connect(gain);
            gain.connect(audioCtx.destination);

            osc.start(startTime);
            osc.stop(startTime + duration);
            
            oscillatorNodes.push(osc);
        }

        function playBirthdayTune() {
            initAudio();
            isPlaying = true;
            musicBtn.classList.remove('hidden');
            musicBtn.innerHTML = '<i class="fas fa-volume-up"></i>';

            const now = audioCtx.currentTime;
            
            const melody = [
                { f: 392.00, d: 0.4 }, { f: 392.00, d: 0.4 }, { f: 440.00, d: 0.8 }, { f: 392.00, d: 0.8 }, { f: 523.25, d: 0.8 }, { f: 493.88, d: 1.6 }, // Line 1
                { f: 392.00, d: 0.4 }, { f: 392.00, d: 0.4 }, { f: 440.00, d: 0.8 }, { f: 392.00, d: 0.8 }, { f: 587.33, d: 0.8 }, { f: 523.25, d: 1.6 }, // Line 2
                { f: 392.00, d: 0.4 }, { f: 392.00, d: 0.4 }, { f: 783.99, d: 0.8 }, { f: 659.25, d: 0.8 }, { f: 523.25, d: 0.8 }, { f: 493.88, d: 0.8 }, { f: 440.00, d: 0.8 }, // Line 3
                { f: 698.46, d: 0.4 }, { f: 698.46, d: 0.4 }, { f: 659.25, d: 0.8 }, { f: 523.25, d: 0.8 }, { f: 587.33, d: 0.8 }, { f: 523.25, d: 2.0 }  // Line 4
            ];

            let timeOffset = 0;
            
            melody.forEach(note => {
                playNote(note.f, 'triangle', note.d, now + timeOffset);
                timeOffset += note.d;
            });
        }

        function toggleMusic() {
            if (isPlaying) {
                // Stop all sounds
                oscillatorNodes.forEach(node => {
                    try { node.stop(); } catch(e){}
                });
                oscillatorNodes = [];
                isPlaying = false;
                musicBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                musicBtn.classList.remove('music-btn-anim');
            } else {
                playBirthdayTune();
                musicBtn.classList.add('music-btn-anim');
            }
        }

        // --- Interaction ---
        giftBox.addEventListener('click', () => {
            // 1. Explode Box
            giftBox.classList.remove('floating-box', 'shake-hover');
            giftBox.classList.add('explode-box');
            
            // 2. Transition UI
            setTimeout(() => {
                introScreen.style.display = 'none';
                mainCard.classList.remove('hidden');
                mainCard.classList.add('card-pop-in');
                
                // 3. Trigger Staggered Text
                setTimeout(revealText, 200);

                // 4. Start FX & Music
                startCelebration();
                playBirthdayTune();
            }, 500);
        });

        function revealText() {
            const elements = document.querySelectorAll('.stagger-reveal');
            elements.forEach((el, index) => {
                setTimeout(() => {
                    el.classList.add('visible');
                }, index * 150); // 150ms delay between each item
            });
        }

        function startCelebration() {
            balloonsContainer.classList.remove('hidden');
            createBalloons();
            initConfetti();
            animateConfetti();
        }

        function replayCelebration() {
            // Reset text animations
            const elements = document.querySelectorAll('.stagger-reveal');
            elements.forEach(el => el.classList.remove('visible'));
            
            // Re-trigger text and fx
            setTimeout(revealText, 200);
            confettiParticles = []; 
            initConfetti();
            
            // Restart Music
            toggleMusic(); // Reset
            setTimeout(() => {
                if(!isPlaying) toggleMusic(); // Start again
            }, 100);
        }

        // --- Background Particles System ---
        function createBackgroundParticles() {
            const particleCount = 20;
            for(let i=0; i<particleCount; i++) {
                const p = document.createElement('div');
                p.classList.add('particle');
                const size = Math.random() * 20 + 5;
                p.style.width = `${size}px`;
                p.style.height = `${size}px`;
                p.style.left = `${Math.random() * 100}%`;
                p.style.animationDuration = `${Math.random() * 15 + 10}s`;
                p.style.animationDelay = `${Math.random() * 5}s`;
                particlesContainer.appendChild(p);
            }
        }

        // --- Advanced Balloon System ---
        function createBalloons() {
            balloonsContainer.innerHTML = ''; // Clear previous
            const balloonColors = ['#FF69B4', '#87CEEB', '#FFA500', '#98FB98', '#DDA0DD', '#FF4500'];
            const count = 20;

            for (let i = 0; i < count; i++) {
                const balloon = document.createElement('div');
                balloon.classList.add('balloon');
                
                const color = balloonColors[Math.floor(Math.random() * balloonColors.length)];
                const size = 45 + Math.random() * 30;
                
                balloon.style.backgroundColor = color;
                balloon.style.width = `${size}px`;
                balloon.style.height = `${size * 1.2}px`;
                balloon.style.left = `${Math.random() * 90 + 5}%`; // Keep within screen
                
                // Randomize rise speed and wobble
                const duration = 8 + Math.random() * 5;
                balloon.style.animationDuration = `${duration}s`;
                balloon.style.animationDelay = `${Math.random() * 3}s`; // Stagger start

                balloonsContainer.appendChild(balloon);
            }
        }

        // --- Advanced Confetti Physics ---
        let confettiParticles = [];
        const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#00ffff', '#ff00ff', '#FFFFFF'];

        function initConfetti() {
            const count = 250;
            for (let i = 0; i < count; i++) {
                confettiParticles.push({
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    r: Math.random() * 6 + 4, // Radius/Size
                    color: colors[Math.floor(Math.random() * colors.length)],
                    vx: (Math.random() - 0.5) * 25, // Horizontal burst
                    vy: (Math.random() - 0.5) * 25 - 5, // Vertical burst
                    tilt: Math.floor(Math.random() * 10) - 10,
                    tiltAngle: 0,
                    tiltAngleIncrement: (Math.random() * 0.07) + 0.05,
                    drag: 0.96, // Air resistance
                    gravity: 0.2
                });
            }
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            let active = false;

            confettiParticles.forEach((p) => {
                // Physics
                p.tiltAngle += p.tiltAngleIncrement;
                p.x += Math.sin(p.tiltAngle) * 2; // Horizontal drift (flutter)
                p.y += (Math.cos(p.tiltAngle) + p.r / 2) / 2; // Vertical flutter
                
                p.x += p.vx;
                p.y += p.vy;
                
                p.vx *= p.drag;
                p.vy += p.gravity;

                // Drawing (Rotating Rectangles)
                ctx.beginPath();
                ctx.lineWidth = p.r / 2;
                ctx.strokeStyle = p.color;
                ctx.moveTo(p.x + p.tilt + p.r, p.y);
                ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r);
                ctx.stroke();

                // Check bounds
                if (p.y < canvas.height) active = true;
            });

            if (active) {
                requestAnimationFrame(animateConfetti);
            }
        }
    </script>
</body>
</html>
